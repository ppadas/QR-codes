# Скрипты для анализа прогонов и отписывания результатов
Этот репозиторий является частью проекта по декодированию баркодов.

### Входные данные
В рамках проекта был утвержден формат хранения результатов и разметки.
Предлагается привести вашу разметку из формата COCO json к нашему с помощье скрипта *make_one_format.py*.
Запускать следует со следующими параметрами: 
- -f путь к вашему файлу с разметкой в формате COCO json
- -o путь до файла, куда сохранить результат

### Сбор статистики
#### Соединение репорта и маркапа
Для сбора результатов сначала нужно соединить репорт прогона с имеющейся разметкой. Для этого можно использовать скрипт *make_one_report/match_report_result.py*.
Запускать следует со следующими параметрами: 
- -r путь до файла с репортом прогона
- -m путь до файла с разметкой
- -d путь до файла, куда сохранить результат

#### Сбор статистик
Для оценки интересующих параметров нужно использовать скрипт *common_stat.py*. Этот скрипт мэтсит коробки из маркапа и из репорта и считает такие характеристики как IOU, типы коробок, максимальная зазор между границами внутрь маркапа и тд. Здесь проставляется глобальнаый тип ошибки: TP, FP, FN. Также скрипт сохраняет результат мэтчинга коробок, если далее вы захотите его переиспользовать или посчитать свои статистики.
Запускать следует со следующими параметрами: 
- -r путь до файла с репортом прогона, соединенного с маркапом
- -s путь до файла, куда сохранить результат статистик
- -m путь до файла, куда сохранить результат мэтчинга коробок

#### Анализ результатов
Для анализа результатов предлагается использовать скрипты *save_error_types.py* и *save_per_file.py*.
Первый скрипт сохраняет названия картинок, на которых есть коробка/пара коробок, соответствующая какому-то типа ошибок.
Запускать следует со следующими параметрами:
- -s путь до файла с сохраненными результатами статистик
- -f путь до файла, куда сохранить имена картинок
- -o опция, показывающая какого типа ошибки отписать (смотри доступные в описании параметра)

Второй скрипт позволяет отписать картинки с нарисованными коробками по файлу с названиями картинок. Зеленым будет отрисован маркап, красным -- найденные коробки, рядом будет написана первая буква класса кода.
Запускать следует со следующими параметрами:
- -f путь до файла с именами картинок
- -d путь до датасета
- -s путь до файла со статистикой
- -o путь до дириктории для сохранения картинок

#### Быстрый запуск
Сбор статистик и анализ результатов с сохранением картинок по всем типам ошибок можно сделать с помощью *make_all_steps.py*.
Запускать следует со следующими параметрами:
- -r путь до файла с репортом прогона, соединенного с маркапом
- -d путь до датасета
- -o путь до дириктории для сохранения картинок
